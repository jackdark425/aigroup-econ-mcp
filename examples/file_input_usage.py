"""
æ–‡ä»¶è¾“å…¥åŠŸèƒ½ä½¿ç”¨ç¤ºä¾‹
æ¼”ç¤ºå¦‚ä½•ä½¿ç”¨CSVå’ŒJSONæ–‡ä»¶ä½œä¸ºMCPå·¥å…·çš„è¾“å…¥
"""

import asyncio
import json


# ç¤ºä¾‹1: CSVæ–‡ä»¶å†…å®¹ï¼ˆæè¿°æ€§ç»Ÿè®¡ï¼‰
csv_example_descriptive = """
GDPå¢é•¿ç‡,é€šè´§è†¨èƒ€ç‡,å¤±ä¸šç‡
3.2,2.1,4.5
2.8,2.3,4.2
3.5,1.9,4.0
2.9,2.4,4.3
3.1,2.2,4.1
2.7,2.5,4.4
3.3,2.0,3.9
3.0,2.3,4.2
"""

# ç¤ºä¾‹2: JSONæ–‡ä»¶å†…å®¹ï¼ˆæè¿°æ€§ç»Ÿè®¡ï¼‰
json_example_descriptive = {
    "GDPå¢é•¿ç‡": [3.2, 2.8, 3.5, 2.9, 3.1, 2.7, 3.3, 3.0],
    "é€šè´§è†¨èƒ€ç‡": [2.1, 2.3, 1.9, 2.4, 2.2, 2.5, 2.0, 2.3],
    "å¤±ä¸šç‡": [4.5, 4.2, 4.0, 4.3, 4.1, 4.4, 3.9, 4.2]
}

# ç¤ºä¾‹3: CSVæ–‡ä»¶å†…å®¹ï¼ˆå›å½’åˆ†æï¼‰
csv_example_regression = """
å¹¿å‘Šæ”¯å‡º,ä»·æ ¼,ç«äº‰å¯¹æ‰‹æ•°é‡,é”€å”®é¢
800,99,3,12000
900,95,3,13500
750,102,4,11800
1000,98,3,14200
850,96,4,13800
950,94,3,15100
"""

# ç¤ºä¾‹4: JSONæ–‡ä»¶å†…å®¹ï¼ˆå›å½’åˆ†æï¼‰
json_example_regression = {
    "å¹¿å‘Šæ”¯å‡º": [800, 900, 750, 1000, 850, 950],
    "ä»·æ ¼": [99, 95, 102, 98, 96, 94],
    "ç«äº‰å¯¹æ‰‹æ•°é‡": [3, 3, 4, 3, 4, 3],
    "é”€å”®é¢": [12000, 13500, 11800, 14200, 13800, 15100]
}

# ç¤ºä¾‹5: æ—¶é—´åºåˆ—æ•°æ®
csv_example_timeseries = """
date,stock_price
2024-01-01,100.5
2024-01-02,102.3
2024-01-03,101.8
2024-01-04,103.5
2024-01-05,104.2
2024-01-06,103.8
2024-01-07,105.1
"""

# ç¤ºä¾‹6: é¢æ¿æ•°æ®
csv_example_panel = """
company_id,year,revenue,employees,investment
1,2020,1000,50,100
1,2021,1100,52,110
1,2022,1200,55,120
2,2020,800,40,80
2,2021,900,42,90
2,2022,1000,45,100
3,2020,1200,60,150
3,2021,1300,62,160
3,2022,1400,65,170
"""


def demo_usage():
    """æ¼”ç¤ºå¦‚ä½•åœ¨MCPä¸­ä½¿ç”¨æ–‡ä»¶è¾“å…¥"""
    
    print("=" * 60)
    print("æ–‡ä»¶è¾“å…¥åŠŸèƒ½ä½¿ç”¨ç¤ºä¾‹")
    print("=" * 60)
    
    # ç¤ºä¾‹1: ä½¿ç”¨CSVè¿›è¡Œæè¿°æ€§ç»Ÿè®¡
    print("\nğŸ“Š ç¤ºä¾‹1: CSVæ ¼å¼ - æè¿°æ€§ç»Ÿè®¡åˆ†æ")
    print("-" * 60)
    print("å·¥å…·è°ƒç”¨: descriptive_statistics")
    print("\nå‚æ•°:")
    print(f"  file_content: {csv_example_descriptive[:100]}...")
    print(f"  file_format: 'csv'")
    print("\nâœ… ç³»ç»Ÿä¼šè‡ªåŠ¨:")
    print("  - æ£€æµ‹CSVåˆ†éš”ç¬¦")
    print("  - è¯†åˆ«åˆ—åï¼ˆGDPå¢é•¿ç‡, é€šè´§è†¨èƒ€ç‡, å¤±ä¸šç‡ï¼‰")
    print("  - è§£ææ•°å€¼æ•°æ®")
    print("  - è®¡ç®—æè¿°æ€§ç»Ÿè®¡")
    
    # ç¤ºä¾‹2: ä½¿ç”¨JSONè¿›è¡Œæè¿°æ€§ç»Ÿè®¡
    print("\nğŸ“Š ç¤ºä¾‹2: JSONæ ¼å¼ - æè¿°æ€§ç»Ÿè®¡åˆ†æ")
    print("-" * 60)
    print("å·¥å…·è°ƒç”¨: descriptive_statistics")
    print("\nå‚æ•°:")
    print(f"  file_content: {json.dumps(json_example_descriptive, ensure_ascii=False, indent=2)[:150]}...")
    print(f"  file_format: 'json' (æˆ– 'auto')")
    print("\nâœ… ç³»ç»Ÿä¼šè‡ªåŠ¨è¯†åˆ«JSONæ ¼å¼å¹¶è§£æ")
    
    # ç¤ºä¾‹3: ä½¿ç”¨CSVè¿›è¡Œå›å½’åˆ†æ
    print("\nğŸ“ˆ ç¤ºä¾‹3: CSVæ ¼å¼ - OLSå›å½’åˆ†æ")
    print("-" * 60)
    print("å·¥å…·è°ƒç”¨: ols_regression")
    print("\nå‚æ•°:")
    print(f"  file_content: {csv_example_regression[:100]}...")
    print(f"  file_format: 'csv'")
    print("\nâœ… ç³»ç»Ÿä¼šè‡ªåŠ¨:")
    print("  - è¯†åˆ«å› å˜é‡ï¼ˆæœ€åä¸€åˆ—ï¼šé”€å”®é¢ï¼‰")
    print("  - è¯†åˆ«è‡ªå˜é‡ï¼ˆå‰é¢çš„åˆ—ï¼šå¹¿å‘Šæ”¯å‡º, ä»·æ ¼, ç«äº‰å¯¹æ‰‹æ•°é‡ï¼‰")
    print("  - æ„å»ºå›å½’æ¨¡å‹")
    
    # ç¤ºä¾‹4: æ—¶é—´åºåˆ—åˆ†æ
    print("\nğŸ“‰ ç¤ºä¾‹4: CSVæ ¼å¼ - æ—¶é—´åºåˆ—åˆ†æ")
    print("-" * 60)
    print("å·¥å…·è°ƒç”¨: time_series_analysis")
    print("\nå‚æ•°:")
    print(f"  file_content: {csv_example_timeseries[:80]}...")
    print(f"  file_format: 'csv'")
    print("\nâœ… ç³»ç»Ÿä¼šè‡ªåŠ¨:")
    print("  - è¯†åˆ«æ—¶é—´åˆ—ï¼ˆdateï¼‰")
    print("  - æå–æ•°å€¼åºåˆ—ï¼ˆstock_priceï¼‰")
    print("  - è¿›è¡Œå¹³ç¨³æ€§æ£€éªŒå’Œè‡ªç›¸å…³åˆ†æ")
    
    # ç¤ºä¾‹5: é¢æ¿æ•°æ®åˆ†æ
    print("\nğŸ¢ ç¤ºä¾‹5: CSVæ ¼å¼ - é¢æ¿æ•°æ®åˆ†æ")
    print("-" * 60)
    print("å·¥å…·è°ƒç”¨: panel_fixed_effects")
    print("\nå‚æ•°:")
    print(f"  file_content: {csv_example_panel[:100]}...")
    print(f"  file_format: 'csv'")
    print("\nâœ… ç³»ç»Ÿä¼šè‡ªåŠ¨:")
    print("  - è¯†åˆ«å®ä½“IDï¼ˆcompany_idï¼‰")
    print("  - è¯†åˆ«æ—¶é—´æ ‡è¯†ï¼ˆyearï¼‰")
    print("  - è¯†åˆ«å› å˜é‡å’Œè‡ªå˜é‡")
    print("  - æ‰§è¡Œé¢æ¿æ•°æ®æ¨¡å‹")
    
    print("\n" + "=" * 60)
    print("ğŸ’¡ ä½¿ç”¨æç¤º:")
    print("=" * 60)
    print("1. file_formatå‚æ•°å¯ä»¥è®¾ç½®ä¸º'auto'ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨æ£€æµ‹")
    print("2. CSVæ–‡ä»¶å»ºè®®åŒ…å«åˆ—åè¡¨å¤´ï¼Œä»¥ä¾¿æ›´å¥½åœ°è¯†åˆ«å˜é‡")
    print("3. JSONæ”¯æŒå¤šç§æ ¼å¼ï¼ŒåŒ…æ‹¬å­—å…¸å’Œæ•°ç»„å½¢å¼")
    print("4. ç³»ç»Ÿä¼šæ ¹æ®å˜é‡åæ™ºèƒ½è¯†åˆ«æ•°æ®ç±»å‹ï¼ˆæ—¶é—´åºåˆ—/é¢æ¿/å›å½’ï¼‰")
    print("5. æ‰€æœ‰åŸæœ‰çš„ç›´æ¥æ•°æ®è¾“å…¥æ–¹å¼ä»ç„¶å®Œå…¨æ”¯æŒ")
    print("=" * 60)


def show_file_formats():
    """å±•ç¤ºæ”¯æŒçš„æ–‡ä»¶æ ¼å¼"""
    
    print("\nğŸ“ æ”¯æŒçš„æ–‡ä»¶æ ¼å¼è¯¦è§£")
    print("=" * 60)
    
    print("\n1ï¸âƒ£ CSVæ ¼å¼:")
    print("-" * 60)
    print("æ ¼å¼1 - å¸¦è¡¨å¤´ï¼ˆæ¨èï¼‰:")
    print("""
å˜é‡1,å˜é‡2,å˜é‡3
1.2,3.4,5.6
2.3,4.5,6.7
3.4,5.6,7.8
""")
    
    print("æ ¼å¼2 - æ— è¡¨å¤´ï¼ˆè‡ªåŠ¨ç”Ÿæˆåˆ—åï¼‰:")
    print("""
1.2,3.4,5.6
2.3,4.5,6.7
3.4,5.6,7.8
""")
    print("â†’ è‡ªåŠ¨å‘½åä¸º: var1, var2, var3")
    
    print("\n2ï¸âƒ£ JSONæ ¼å¼:")
    print("-" * 60)
    print("æ ¼å¼1 - å­—å…¸å½¢å¼ï¼ˆæ¨èï¼‰:")
    print("""
{
    "å˜é‡1": [1.2, 2.3, 3.4],
    "å˜é‡2": [3.4, 4.5, 5.6],
    "å˜é‡3": [5.6, 6.7, 7.8]
}
""")
    
    print("æ ¼å¼2 - æ•°ç»„å½¢å¼:")
    print("""
[
    {"å˜é‡1": 1.2, "å˜é‡2": 3.4, "å˜é‡3": 5.6},
    {"å˜é‡1": 2.3, "å˜é‡2": 4.5, "å˜é‡3": 6.7},
    {"å˜é‡1": 3.4, "å˜é‡2": 5.6, "å˜é‡3": 7.8}
]
""")
    
    print("æ ¼å¼3 - åµŒå¥—ç»“æ„:")
    print("""
{
    "data": {
        "å˜é‡1": [1.2, 2.3, 3.4],
        "å˜é‡2": [3.4, 4.5, 5.6]
    },
    "metadata": {
        "description": "ç¤ºä¾‹æ•°æ®"
    }
}
""")


def show_variable_recognition():
    """å±•ç¤ºæ™ºèƒ½å˜é‡è¯†åˆ«åŠŸèƒ½"""
    
    print("\nğŸ¤– æ™ºèƒ½å˜é‡è¯†åˆ«åŠŸèƒ½")
    print("=" * 60)
    
    print("\nğŸ“Œ æ—¶é—´åºåˆ—è‡ªåŠ¨è¯†åˆ«:")
    print("åŒ…å«ä»¥ä¸‹å…³é”®è¯çš„åˆ—åä¼šè¢«è¯†åˆ«ä¸ºæ—¶é—´æ ‡è¯†ï¼š")
    print("  â€¢ time, date, year, month, day, period, quarter")
    
    print("\nğŸ“Œ å®ä½“IDè‡ªåŠ¨è¯†åˆ«:")
    print("åŒ…å«ä»¥ä¸‹å…³é”®è¯çš„åˆ—åä¼šè¢«è¯†åˆ«ä¸ºå®ä½“æ ‡è¯†ï¼š")
    print("  â€¢ id, entity, firm, company, country, region")
    
    print("\nğŸ“Œ å›å½’åˆ†æå˜é‡åˆ†é…:")
    print("  â€¢ æœ€åä¸€åˆ— â†’ å› å˜é‡ (y)")
    print("  â€¢ å…¶ä»–æ•°å€¼åˆ— â†’ è‡ªå˜é‡ (x)")
    
    print("\nğŸ“Œ é¢æ¿æ•°æ®å˜é‡åˆ†é…:")
    print("  1. è¯†åˆ«å®ä½“IDåˆ—")
    print("  2. è¯†åˆ«æ—¶é—´æ ‡è¯†åˆ—")
    print("  3. æœ€åä¸€ä¸ªæ•°æ®åˆ— â†’ å› å˜é‡")
    print("  4. å…¶ä»–æ•°æ®åˆ— â†’ è‡ªå˜é‡")
    
    print("\nğŸ’¡ ç¤ºä¾‹:")
    print("-" * 60)
    print("CSVæ–‡ä»¶:")
    print("""
company_id,year,sales,advertising,price
1,2020,1000,100,50
1,2021,1100,110,48
2,2020,900,90,52
2,2021,1000,95,50
""")
    
    print("\nè‡ªåŠ¨è¯†åˆ«ç»“æœ:")
    print("  âœ“ å®ä½“ID: company_id")
    print("  âœ“ æ—¶é—´æ ‡è¯†: year")
    print("  âœ“ å› å˜é‡: price")
    print("  âœ“ è‡ªå˜é‡: sales, advertising")
    print("  âœ“ æ•°æ®ç±»å‹: é¢æ¿æ•°æ®")
    print("  âœ“ æ¨èå·¥å…·: panel_fixed_effects, panel_random_effects")


if __name__ == "__main__":
    demo_usage()
    show_file_formats()
    show_variable_recognition()
    
    print("\n" + "=" * 60)
    print("âœ¨ å®Œæˆï¼ç°åœ¨ä½ å¯ä»¥ä½¿ç”¨CSV/JSONæ–‡ä»¶åŠ é€Ÿæ•°æ®åˆ†æäº†ï¼")
    print("=" * 60)